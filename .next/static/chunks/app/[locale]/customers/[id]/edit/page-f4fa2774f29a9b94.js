(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[288],{13538:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(95155),a=r(82792),o=r(35695),i=r(17652),n=r(72797),l=r(12115),d=r(90697),c=r(13568),u=r(35169),m=r(6874),p=r.n(m);function h(e){let{params:t}=e,r=(0,i.c3)("Customers"),m=(0,n.Ym)(),h=(0,o.useRouter)(),[g,x]=(0,l.useState)(null),[b,f]=(0,l.useState)(!0);(0,l.useEffect)(()=>{(async()=>{try{let e=(await d.uE.get("/customers/".concat(t.id))).data;if(!e.success)throw Error(e.error||r("customerNotFound"));x(e.data)}catch(a){var e,s;let t=(null==(s=a.response)||null==(e=s.data)?void 0:e.error)||a.message||r("unknownError");c.Ay.error(t)}finally{f(!1)}})()},[t.id,r]);let N=async e=>{try{let s=(await d.uE.put("/customers/".concat(t.id),e)).data;if(!s.success)throw Error(s.error||r("errors.submissionFailed"));c.Ay.success(r("updateSuccess")),h.push("/".concat(m,"/customers"))}catch(t){var s,a;let e=(null==(a=t.response)||null==(s=a.data)?void 0:s.error)||t.message||r("unknownError");c.Ay.error(e)}};return b?(0,s.jsx)("div",{className:"flex justify-center items-center min-h-[60vh] text-[#2563eb] font-semibold",children:r("loading")}):g?(0,s.jsx)("div",{className:"flex justify-center items-center min-h-[80vh] bg-[#f9fafb] dark:bg-gray-950 px-2",children:(0,s.jsxs)("div",{className:"w-full max-w-xl bg-white dark:bg-gray-900 rounded-2xl shadow-lg p-8 border border-gray-100 dark:border-gray-800",children:[(0,s.jsxs)("div",{className:"flex items-center mb-6 gap-2",children:[(0,s.jsx)(p(),{href:"/".concat(m,"/customers"),className:"text-[#2563eb] hover:text-[#1d4ed8] transition",children:(0,s.jsx)(u.A,{className:"h-5 w-5"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-[#2563eb] dark:text-[#60a5fa]",children:r("editCustomer")})]}),(0,s.jsx)(a.N,{initialData:g,onSubmit:N,onCancel:()=>h.push("/".concat(m,"/customers"))})]})}):(0,s.jsx)("div",{className:"flex justify-center items-center min-h-[60vh] text-red-500 font-semibold",children:r("customerNotFound")})}},35169:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(19946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},48095:(e,t,r)=>{Promise.resolve().then(r.bind(r,13538))},59434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>o});var s=r(52596),a=r(39688);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},62523:(e,t,r)=>{"use strict";r.d(t,{p:()=>o});var s=r(95155);r(12115);var a=r(59434);function o(e){let{className:t,type:r,...o}=e;return(0,s.jsx)("input",{type:r,"data-slot":"input",className:(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...o})}},79323:(e,t,r)=>{"use strict";r.d(t,{u:()=>a});var s=r(23464);class a{static async login(e){try{return(await s.A.post("".concat(this.BASE_URL,"/auth/login"),{userNameOrEmailAddress:e.userNameOrEmailAddress,password:e.password,rememberMe:e.rememberMe},{headers:{"Content-Type":"application/json"}})).data}catch(e){var t,r,a;throw console.error("AuthService login error:",e),Error((null==(a=e.response)||null==(r=a.data)||null==(t=r.error)?void 0:t.message)||"فشل في الاتصال بالخادم")}}static saveToken(e,t,r){if(localStorage.setItem(this.TOKEN_KEY,e),t&&localStorage.setItem(this.REFRESH_TOKEN_KEY,t),r){let e=Date.now()+1e3*r;localStorage.setItem(this.TOKEN_EXPIRY_KEY,e.toString())}}static getToken(){{let e=localStorage.getItem(this.TOKEN_KEY);return(console.log("\uD83D\uDD11 AuthService.getToken() called:",{tokenExists:!!e,tokenPreview:(null==e?void 0:e.substring(0,30))+"...",isExpired:!!e&&this.isTokenExpired()}),e&&this.isTokenExpired())?(console.log("⚠️ Token expired, attempting refresh..."),null):e}}static saveUser(e){localStorage.setItem(this.USER_KEY,JSON.stringify(e))}static getUser(){{let e=localStorage.getItem(this.USER_KEY);return e?JSON.parse(e):null}}static logout(){localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.REFRESH_TOKEN_KEY),localStorage.removeItem(this.TOKEN_EXPIRY_KEY),localStorage.removeItem(this.USER_KEY)}static getRefreshToken(){return localStorage.getItem(this.REFRESH_TOKEN_KEY)}static isTokenExpired(){{let e=localStorage.getItem(this.TOKEN_EXPIRY_KEY);if(e)return Date.now()>parseInt(e)}return!1}static getTokenExpiryTime(){{let e=localStorage.getItem(this.TOKEN_EXPIRY_KEY);return e?parseInt(e):null}}static isAuthenticated(){return null!==this.getToken()&&!this.isTokenExpired()}static getAuthHeaders(){let e=this.getToken();return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}}a.BASE_URL="/api",a.TOKEN_KEY="authToken",a.REFRESH_TOKEN_KEY="refreshToken",a.TOKEN_EXPIRY_KEY="tokenExpiry",a.USER_KEY="userInfo",s.A.interceptors.request.use(e=>{let t=a.getToken();return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),s.A.interceptors.response.use(e=>e,e=>{var t;return(null==(t=e.response)?void 0:t.status)===401&&(a.logout(),window.location.href="/login"),Promise.reject(e)})},82792:(e,t,r)=>{"use strict";r.d(t,{N:()=>d});var s=r(95155),a=r(62177),o=r(17652),i=r(62523),n=r(85057),l=r(12115);function d(e){let{initialData:t,onSubmit:r,onSuccess:d,onError:c,onCancel:u,loading:m=!1}=e,p=(0,o.c3)("Customers"),{register:h,handleSubmit:g,formState:{errors:x}}=(0,a.mN)({defaultValues:t}),[b,f]=(0,l.useState)(!1),N=async e=>{f(!0);try{await r(e),d&&d()}catch(e){console.error("Form submission error:",e),c&&c(e instanceof Error?e.message:String(e))}finally{f(!1)}},v=!!t;return(0,s.jsxs)("form",{onSubmit:g(N),className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(n.J,{htmlFor:"fullName",className:"text-black dark:text-white",children:[p("fullName")," *"]}),(0,s.jsx)(i.p,{id:"fullName",...h("fullName",{required:p("validation.required")})}),x.fullName&&(0,s.jsx)("p",{className:"text-sm text-red-500",children:x.fullName.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(n.J,{htmlFor:"mobileNumber",className:"text-black dark:text-white",children:[p("mobileNumber")," *"]}),(0,s.jsx)(i.p,{id:"mobileNumber",...h("mobileNumber",{required:p("validation.required"),pattern:{value:/^[0-9]+$/,message:p("errors.invalidMobile")||"Invalid mobile number"}})}),x.mobileNumber&&(0,s.jsx)("p",{className:"text-sm text-red-500",children:x.mobileNumber.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(n.J,{htmlFor:"userName",className:"text-black dark:text-white",children:[p("userName",{defaultValue:"Username"})," *"]}),(0,s.jsx)(i.p,{id:"userName",...h("userName",{required:p("validation.required")})}),x.userName&&(0,s.jsx)("p",{className:"text-sm text-red-500",children:x.userName.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(n.J,{htmlFor:"password",className:"text-black dark:text-white",children:[p("password",{defaultValue:"Password"})," *"]}),(0,s.jsx)(i.p,{id:"password",type:"password",...h("password",{required:p("validation.required"),minLength:{value:8,message:p("errors.passwordMinLength")},validate:{hasLowercase:e=>/[a-z]/.test(e)||p("errors.passwordLowercase"),hasUppercase:e=>/[A-Z]/.test(e)||p("errors.passwordUppercase"),hasSpecial:e=>/[!@#$%^&*]/.test(e)||p("errors.passwordSpecial")}})}),x.password&&(0,s.jsx)("p",{className:"text-sm text-red-500",children:x.password.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(n.J,{htmlFor:"masterMobileNumber",className:"text-black dark:text-white",children:[p("masterMobileNumber")," (",p("optional",{defaultValue:"Optional"}),")"]}),(0,s.jsx)(i.p,{id:"masterMobileNumber",...h("masterMobileNumber")})]}),(0,s.jsxs)("div",{className:"flex gap-2 mt-6 justify-end",children:[(0,s.jsx)("button",{type:"submit",className:"h-10 px-4 rounded-lg bg-[#2563eb] hover:bg-[#1d4ed8] text-white font-semibold transition flex items-center gap-2",disabled:b||m,title:v?p("update"):p("create"),children:b||m?p("submitting",{defaultValue:"Submitting..."}):v?p("update",{defaultValue:"Update"}):p("create",{defaultValue:"Create"})}),(0,s.jsx)("button",{type:"button",onClick:()=>u&&u(),className:"h-10 px-4 rounded-lg bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-800 dark:text-gray-200 font-semibold transition flex items-center gap-2",disabled:b||m,title:p("cancel"),children:p("cancel",{defaultValue:"Cancel"})})]})]})}},85057:(e,t,r)=>{"use strict";r.d(t,{J:()=>i});var s=r(95155);r(12115);var a=r(40968),o=r(59434);function i(e){let{className:t,...r}=e;return(0,s.jsx)(a.b,{"data-slot":"label",className:(0,o.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...r})}},90697:(e,t,r)=>{"use strict";r.d(t,{FH:()=>n,uE:()=>o,xU:()=>l});var s=r(23464),a=r(79323);let o=(()=>{let e=s.A.create({baseURL:"/api",timeout:1e4,headers:{"Content-Type":"application/json"}});return e.interceptors.request.use(e=>{var t;let r=a.u.getToken();return console.log("\uD83D\uDD0D Token retrieved:",r?"Found":"Not found",(null==r?void 0:r.substring(0,20))+"..."),r?(e.headers.Authorization="Bearer ".concat(r),console.log("✅ Authorization header set")):console.log("❌ No token found, Authorization header not set"),console.log("API Request:",{method:null==(t=e.method)?void 0:t.toUpperCase(),url:e.url,headers:e.headers,data:e.data}),e},e=>(console.error("Request interceptor error:",e),Promise.reject(e))),e.interceptors.response.use(e=>(console.log("API Response:",{status:e.status,statusText:e.statusText,data:e.data}),e),e=>{var t;if(console.error("Response interceptor error:",e),(null==(t=e.response)?void 0:t.status)===401){console.log("Unauthorized access, logging out..."),a.u.logout();{let e=window.location.pathname.split("/")[1]||"ar";window.location.href="/".concat(e,"/login")}}return Promise.reject(e)}),e})(),i=s.A.create({baseURL:"https://neosending.com/api",timeout:15e3,headers:{"Content-Type":"application/json",Accept:"text/plain","User-Agent":"NeoSend-Client/1.0"}});i.interceptors.request.use(e=>{var t;let r=a.u.getToken();return r&&(e.headers.Authorization="Bearer ".concat(r)),console.log("NeoSend API Request:",{method:null==(t=e.method)?void 0:t.toUpperCase(),url:e.url,headers:e.headers}),e},e=>(console.error("NeoSend request error:",e),Promise.reject(e))),i.interceptors.response.use(e=>(console.log("NeoSend API Response:",{status:e.status,statusText:e.statusText,data:e.data}),e),e=>(console.error("NeoSend response error:",e),Promise.reject(e)));let n={get:(e,t)=>o.get(e,t),post:(e,t,r)=>o.post(e,t,r),put:(e,t,r)=>o.put(e,t,r),delete:(e,t)=>o.delete(e,t),patch:(e,t,r)=>o.patch(e,t,r)},l={get:(e,t)=>i.get(e,t),post:(e,t,r)=>i.post(e,t,r),put:(e,t,r)=>i.put(e,t,r),delete:(e,t)=>i.delete(e,t)}}},e=>{e.O(0,[803,150,641,794,665,568,72,441,964,358],()=>e(e.s=48095)),_N_E=e.O()}]);