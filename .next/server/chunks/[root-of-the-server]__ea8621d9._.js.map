{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 170, "column": 0}, "map": {"version":3,"sources":["file:///C:/wamp64/www/whatsssss/src/app/api/customers/%5Bid%5D/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport axios from 'axios';\n\nconst API_BASE = 'https://neosending.com/api/neosending/Whatsapp';\n\n// دالة لاستخراج التوكن من الهيدر\nfunction getAuthToken(request: Request): string | null {\n  const authHeader = request.headers.get('authorization');\n  if (authHeader && authHeader.startsWith('Bearer ')) {\n    return authHeader;\n  }\n  return null;\n}\n\n// Helper function for error responses\nfunction errorResponse(message: string, status: number, details?: any) {\n  return NextResponse.json(\n    { success: false, error: message, details },\n    { status }\n  );\n}\n\nexport async function GET(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params;\n\n    if (!id || isNaN(Number(id))) {\n      return errorResponse('معرف العميل غير صالح', 400);\n    }\n\n    // استخراج التوكن من الهيدر\n    const authToken = getAuthToken(request);\n    if (!authToken) {\n      return errorResponse('لم يتم توفير توكن المصادقة', 401);\n    }\n\n    const response = await axios.get(`${API_BASE}/customer/${id}`, {\n      headers: {\n        'Accept': 'application/json',\n        'Authorization': authToken\n      },\n      timeout: 15000\n    });\n\n    return NextResponse.json({\n      success: true,\n      data: response.data\n    });\n\n  } catch (error: any) {\n    console.error('Error fetching customer:', error);\n    return errorResponse(\n      'فشل في جلب بيانات العميل',\n      error.response?.status || 500,\n      error.response?.data || error.message\n    );\n  }\n}\n\nexport async function PUT(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params;\n\n    if (!id || isNaN(Number(id))) {\n      return errorResponse('معرف العميل غير صالح', 400);\n    }\n\n    // استخراج التوكن من الهيدر\n    const authToken = getAuthToken(request);\n    if (!authToken) {\n      return errorResponse('لم يتم توفير توكن المصادقة', 401);\n    }\n\n    const requestData = await request.json();\n\n    const response = await axios.put(`${API_BASE}/customer/${id}`, requestData, {\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n        'Authorization': authToken\n      },\n      timeout: 15000\n    });\n\n    return NextResponse.json({\n      success: true,\n      data: response.data\n    });\n\n  } catch (error: any) {\n    console.error('Error updating customer:', error);\n    return errorResponse(\n      'فشل في تحديث بيانات العميل',\n      error.response?.status || 500,\n      error.response?.data || error.message\n    );\n  }\n}\n\nexport async function DELETE(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  const { id } = await params;\n\n  if (!id || isNaN(Number(id))) {\n    return NextResponse.json(\n      { success: false, error: 'معرف العميل غير صالح' },\n      { status: 400 }\n    );\n  }\n\n  // استخراج التوكن من الهيدر\n  const authToken = getAuthToken(request);\n  if (!authToken) {\n    return NextResponse.json(\n      { success: false, error: 'لم يتم توفير توكن المصادقة' },\n      { status: 401 }\n    );\n  }\n\n  try {\n    const response = await axios.delete(`${API_BASE}/customer/${id}`, {\n      headers: {\n        'Accept': 'text/plain', // فقط هذا الهيدر\n        'Authorization': authToken\n      },\n      timeout: 10000\n    });\n\n    if (response.status >= 200 && response.status < 300) {\n      return NextResponse.json({\n        success: true,\n        message: 'تم حذف العميل بنجاح'\n      });\n    }\n\n    return NextResponse.json(\n      {\n        success: false,\n        error: 'فشل في حذف العميل',\n        details: response.data\n      },\n      { status: response.status }\n    );\n\n  } catch (error: any) {\n    console.error('خطأ في حذف العميل:', error);\n\n    return NextResponse.json(\n      {\n        success: false,\n        error: 'فشل في حذف العميل',\n        details: error.response?.data || error.message\n      },\n      { status: error.response?.status || 500 }\n    );\n  }\n}"],"names":[],"mappings":"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","debugId":null}}]
}